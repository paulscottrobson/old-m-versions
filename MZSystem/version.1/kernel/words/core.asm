; ***********************************************************************************************
; ***********************************************************************************************
;
;		Name : 		core.asm
;		Purpose : 	Core words
;		Author :	Paul Robson (paul@robsons.org.uk)
;		Created : 	30th September 2018
;
; ***********************************************************************************************
; ***********************************************************************************************

; ***********************************************************************************************
;								, 	Compile a Word
; ***********************************************************************************************

; @@word 		,
		jp 		PAGECompileWord

; ***********************************************************************************************
;								c, 	Compile a Byte
; ***********************************************************************************************

; @@word		c,
		ld 		a,l
		jp 		PAGECompileByte

; ***********************************************************************************************
;								i, 	Compile an instruction
; ***********************************************************************************************

; @@word		i,
		jp 		PAGECompileInstruction

; ***********************************************************************************************
;								; 	Return from subroutine
; ***********************************************************************************************

; @@macro.nx	;
		ld 		a,$C9
		jp 		PAGECompileByte

; ***********************************************************************************************
;								.h  Print A
; ***********************************************************************************************

; @@word 		.h
		jp 		DEBUGPrintHL

; ***********************************************************************************************
;									Stop the CPU
; ***********************************************************************************************

; @@word 		halt		
		jp 		HaltSystem

; ***********************************************************************************************
;						  Display debug information on bottom line
; ***********************************************************************************************

; @@word 		debug
		jp 		DebugCode

; ***********************************************************************************************
;								Make the last definition a macro 
; ***********************************************************************************************

; @@macro 		macro
		ld 		a,2
__ORLastTypeIDWithA:
		push 	hl
		ld 		l,a
		call 	DICTORLastTypeID
		pop 	hl
		ret

; ***********************************************************************************************
;							Make the last definition compile.only
; ***********************************************************************************************

; @@macro 		compile.only
		ld 		a,0x40
		jr 		__ORLastTypeIDWithA

; ***********************************************************************************************
;									Or the type ID with A
; ***********************************************************************************************

; @@word 		or.type.id
		ld 		a,l
		jr 		__ORLastTypeIDWithA

; *** IMPORTANT *** This is not a macro, it is designed to be used in words that manipulate
; the last definition.

; ***********************************************************************************************
;							   Set cursor position to A
; ***********************************************************************************************

; @@word 		cursor!
		jp 		IOSetCursor

; ***********************************************************************************************
;							  Write B to screen position A
; ***********************************************************************************************

; @@word 		screen!
		ld 		a,e
		jp 		IOWriteCharacter

; ***********************************************************************************************
;							   Clear screen / home cursor
; ***********************************************************************************************

; @@word 		clr.screen
		jp	 	IOClearScreen

; ***********************************************************************************************
;								 Scan the keyboard into A
; ***********************************************************************************************

; @@word 		key@
		call 	IOScanKeyboard
		ld 		l,a
		ld 		h,0
		ret

; ***********************************************************************************************
;										Put B*A in A
; ***********************************************************************************************

; @@word 		*
		jp 		Multiply16

; ***********************************************************************************************
;										Put B/A in A
; ***********************************************************************************************

; @@word 		/
		push 	de
		call	DivideMod16
		ex 		de,hl
		pop 	de
		ret

; ***********************************************************************************************
;									Put Modulus of B/A in A
; ***********************************************************************************************

; @@word 		mod
		push 	de
		call	DivideMod16
		pop 	de
		ret
